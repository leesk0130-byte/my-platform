<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#0f172a">
  <title>ì»¤ë®¤ë‹ˆí‹° | ê°€ë§¹ì ìˆ²</title>
  <meta name="description" content="ì˜¨ë¼ì¸ ê°€ë§¹ì Â·ì‡¼í•‘ëª° ì»¤ë®¤ë‹ˆí‹°. ìˆ˜ìˆ˜ë£ŒÂ·ì •ì‚°Â·ìš´ì˜ ì •ë³´ ë‚˜ëˆ„ê³  ì§ˆë¬¸í•˜ëŠ” ê²Œì‹œíŒ.">
  <link rel="canonical" href="https://my-platform.pages.dev/community.html">
  <meta property="og:type" content="website">
  <meta property="og:title" content="ì»¤ë®¤ë‹ˆí‹° | ê°€ë§¹ì ìˆ²">
  <meta property="og:description" content="ì˜¨ë¼ì¸ ê°€ë§¹ì Â·ì‡¼í•‘ëª° ì»¤ë®¤ë‹ˆí‹°. ìˆ˜ìˆ˜ë£ŒÂ·ì •ì‚°Â·ìš´ì˜ ì •ë³´ ë‚˜ëˆ„ê³  ì§ˆë¬¸í•˜ëŠ” ê²Œì‹œíŒ.">
  <meta property="og:url" content="https://my-platform.pages.dev/community.html">
  <meta property="og:locale" content="ko_KR">
  <meta property="og:image" content="https://my-platform.pages.dev/og-image.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ì»¤ë®¤ë‹ˆí‹° | ê°€ë§¹ì ìˆ²">
  <meta name="twitter:description" content="ì˜¨ë¼ì¸ ê°€ë§¹ì Â·ì‡¼í•‘ëª° ì»¤ë®¤ë‹ˆí‹°. ìˆ˜ìˆ˜ë£ŒÂ·ì •ì‚°Â·ìš´ì˜ ì •ë³´ ë‚˜ëˆ„ê³  ì§ˆë¬¸í•˜ëŠ” ê²Œì‹œíŒ.">
  <meta name="twitter:image" content="https://my-platform.pages.dev/og-image.png">
  <link rel="stylesheet" href="css/common.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3006893636342653" crossorigin="anonymous"></script>
</head>
<body>
  <a href="#main" class="skip-link">ë³¸ë¬¸ìœ¼ë¡œ ê±´ë„ˆë›°ê¸°</a>
  <header>
    <h1><a href="index.html">ê°€ë§¹ì ìˆ²</a></h1>
    <button type="button" class="nav-toggle" aria-label="ë©”ë‰´ ì—´ê¸°" aria-expanded="false" onclick="toggleNav()"><span></span><span></span><span></span></button>
    <nav class="header-nav" id="headerNav" aria-label="ë©”ì¸ ë©”ë‰´">
      <a href="about.html">ê°€ë§¹ì ìˆ²ì´ë€?</a>
      <a href="news.html">ë‰´ìŠ¤</a>
      <a href="pg.html">PG ìˆ˜ìˆ˜ë£Œ</a>
      <a href="calculator.html">ìˆ˜ìˆ˜ë£Œ ê³„ì‚°ê¸°</a>
      <a href="must-know.html">ê¼­ ì•Œì•„ì•¼ í•  ê²ƒ</a>
      <a href="community.html" class="active">ì»¤ë®¤ë‹ˆí‹°</a>
    </nav>
    <div class="header-auth" id="headerAuth" aria-label="ë¡œê·¸ì¸ ìƒíƒœ">
      <span class="header-auth-user" id="headerAuthUser" style="display:none;"><span class="header-user" id="headerUser"></span>
      <button type="button" class="btn btn-outline" id="headerLogoutBtn" onclick="if(window.app&&window.app.logout)window.app.logout();if(typeof updateHeaderAuth==='function')updateHeaderAuth();">ë¡œê·¸ì•„ì›ƒ</button></span>
      <span class="header-auth-guest" id="headerAuthGuest"><button type="button" class="btn btn-outline" id="headerLoginBtn" onclick="openModal('loginModal')">ë¡œê·¸ì¸</button>
      <button type="button" class="btn btn-primary" id="headerSignupBtn" onclick="openModal('signupModal')">íšŒì›ê°€ì…</button></span>
    </div>
  </header>

  <main id="main" class="container page-community">
    <nav class="breadcrumb" aria-label="breadcrumb"><a href="index.html">í™ˆ</a> <span class="bc-sep">/</span> <strong>ì»¤ë®¤ë‹ˆí‹°</strong></nav>
    <div class="hero">
      <h2>ì˜¨ë¼ì¸ ê°€ë§¹ì  ì»¤ë®¤ë‹ˆí‹°</h2>
      <p>PGì‚¬ë§ˆë‹¤ í©ì–´ì§„ ì •ë³´ ì—†ì´, <strong>ì‡¼í•‘ëª°Â·ê°€ë§¹ì ì£¼</strong>ë§Œì„ ìœ„í•œ ê²Œì‹œíŒì…ë‹ˆë‹¤. ìˆ˜ìˆ˜ë£ŒÂ·ì •ì‚°Â·ìš´ì˜ ê¿€íŒì„ ë‚˜ëˆ„ê³  ì§ˆë¬¸í•´ ë³´ì„¸ìš”.</p>
      <p class="hero-hint"><a href="verify.html">ì¸ì¦ëœ ì•„ì´ë””</a>ë¡œ ì´ìš©í•˜ë ¤ë©´ 4ëŒ€ë³´í—˜ ê°€ì…ì´ë ¥ì„ <a href="mailto:leesk0130@naver.com">leesk0130@naver.com</a>ìœ¼ë¡œ ë³´ë‚´ ì£¼ì„¸ìš”.</p>
    </div>
    <section class="section community-section">
      <div class="card">
        <div class="board-tabs">
          <a href="community.html" class="active">ì „ì²´</a>
          <a href="community.html?board=free">ììœ ê²Œì‹œíŒ</a>
          <a href="community.html?board=fee">ìˆ˜ìˆ˜ë£Œ/ì •ì‚°</a>
          <a href="community.html?board=qna">ì§ˆë¬¸ë‹µë³€</a>
          <a href="community.html?board=info">ì •ë³´ê³µìœ </a>
        </div>
        <div class="board-toolbar" id="board-toolbar">
          <div class="board-search">
            <label for="board-search-input" class="sr-only">ì œëª©ìœ¼ë¡œ ê²€ìƒ‰</label>
            <input type="search" id="board-search-input" placeholder="ì œëª© ê²€ìƒ‰" aria-label="ì œëª© ê²€ìƒ‰" autocomplete="off">
            <button type="button" class="btn btn-outline btn-sm" id="board-search-btn" aria-label="ê²€ìƒ‰ ì‹¤í–‰">ì°¾ê¸°</button>
          </div>
          <div class="board-sort">
            <label for="board-sort-select" class="sr-only">ì •ë ¬</label>
            <select id="board-sort-select" aria-label="ì •ë ¬ ê¸°ì¤€">
              <option value="latest">ìµœì‹ ìˆœ</option>
              <option value="hits">ì¡°íšŒìˆœ</option>
            </select>
          </div>
        </div>
        <div class="board-actions" style="justify-content:flex-end;">
          <a href="write.html" class="btn btn-primary">ê¸€ì“°ê¸°</a>
        </div>
        <div id="board-notice" class="board-notice" aria-label="ê³µì§€" style="display:none;"></div>
        <div id="view-loading" class="loading-state" aria-live="polite" data-view="loading">
          <div class="loading-spinner"></div>
          <p>ê¸€ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì´ì—ìš”...</p>
        </div>
        <div id="view-list" data-view="list" style="display:none;">
          <ul class="feed-list" id="community-list" aria-label="ê²Œì‹œê¸€ ëª©ë¡"></ul>
          <div id="posts-more-wrap" class="board-more-wrap" style="display:none;">
            <button type="button" class="btn btn-outline" id="posts-more-btn">ë”ë³´ê¸°</button>
          </div>
        </div>
        <div id="view-empty" class="empty-state" data-view="empty" style="display:none;">
          <p class="empty-state-icon" aria-hidden="true">ğŸ“</p>
          <p class="empty-state-title">ì•„ì§ ì‘ì„±ëœ ê¸€ì´ ì—†ì–´ìš”!</p>
          <p class="empty-state-desc">ì²« ê¸€ì„ ì‘ì„±í•´ ë³´ì„¸ìš”.</p>
          <a href="write.html" class="btn btn-primary">ì²« ê¸€ ì“°ê¸°</a>
        </div>
        <div id="view-not-found" class="empty-state" data-view="notFound" style="display:none; margin:1.5rem 2rem;">
          <p class="empty-state-icon" aria-hidden="true">ğŸ”</p>
          <p class="empty-state-title">ê¸€ì´ ì—†ê±°ë‚˜ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤</p>
          <p class="empty-state-desc">ìš”ì²­í•˜ì‹  ê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ì–´ìš”.</p>
          <a href="community.html" class="btn btn-primary">ëª©ë¡ìœ¼ë¡œ</a>
        </div>
        <div id="view-error" class="empty-state" data-view="error" style="display:none;">
          <p class="empty-state-title">ì¼ì‹œì ì¸ ì˜¤ë¥˜ê°€ ë‚¬ì–´ìš”</p>
          <p class="empty-state-desc" id="view-error-message">ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.</p>
          <button type="button" class="btn btn-primary" id="view-error-retry">ë‹¤ì‹œ ì‹œë„</button>
        </div>
        <div id="view-detail" class="post-detail-wrap" data-view="detail" style="display:none;margin-top:1rem;">
          <div class="post-detail-nav">
            <a href="community.html" class="btn btn-outline btn-back">â† ëª©ë¡ìœ¼ë¡œ</a>
          </div>
          <article class="post-detail-card" aria-label="ê¸€ ë³¸ë¬¸">
            <header class="post-detail-header">
              <p class="post-detail-title-label" aria-hidden="true">ì œëª©</p>
              <h1 id="post-detail-title" class="post-detail-title"></h1>
              <div id="post-detail-meta" class="post-detail-meta"></div>
            </header>
            <div class="post-body-wrap" aria-label="ë³¸ë¬¸ ë‚´ìš©">
              <p class="post-body-label">ë³¸ë¬¸</p>
              <div id="post-detail-body" class="post-body"></div>
            </div>
          </article>
          <section class="comment-section" id="comment-section" aria-label="ëŒ“ê¸€">
            <h2 class="comment-section-title" id="comment-section-title">ëŒ“ê¸€ <span class="comment-count" id="comment-count">0</span></h2>
            <ul class="comment-list" id="comment-list"></ul>
            <div class="comment-form-wrap">
              <p class="comment-form-label">ëŒ“ê¸€ ì‘ì„±</p>
              <form id="comment-form" class="comment-form" onsubmit="return false;">
                <div class="form-group comment-nickname-row" id="comment-nickname-row">
                  <span class="comment-nickname-label">ë‹‰ë„¤ì„</span>
                  <span class="comment-nickname-value" id="comment-nickname-value">â€”</span>
                </div>
                <div class="form-group form-group-checkbox">
                  <label><input type="checkbox" id="comment-anonymous" name="comment-anonymous"> ìµëª…ìœ¼ë¡œ ì‘ì„±</label>
                </div>
                <div class="form-group">
                  <label for="comment-body" class="sr-only">ëŒ“ê¸€ ë‚´ìš©</label>
                  <textarea id="comment-body" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”" required rows="3"></textarea>
                </div>
                <div id="comment-error" class="msg-error" style="display:none;"></div>
                <div class="form-actions">
                  <button type="submit" class="btn btn-primary">ëŒ“ê¸€ ë“±ë¡</button>
                </div>
              </form>
            </div>
          </section>
          <div class="post-detail-nav post-detail-nav-bottom">
            <a href="community.html" class="btn btn-outline btn-back">â† ëª©ë¡ìœ¼ë¡œ</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div class="modal-overlay" id="loginModal"><div class="modal"><div class="modal-header"><h3>ë¡œê·¸ì¸</h3><button type="button" class="modal-close" onclick="closeModal('loginModal')">&times;</button></div><div class="modal-body"><form id="loginForm" onsubmit="return false;"><div class="form-group"><label>ì´ë©”ì¼</label><input type="email" id="login-email" required></div><div class="form-group"><label>ë¹„ë°€ë²ˆí˜¸</label><input type="password" id="login-pw" required></div><div id="login-error" class="msg-error" style="display:none;"></div><div id="login-success" class="msg-success" style="display:none;"></div><div class="modal-footer"><button type="submit" class="btn btn-primary" id="login-submit-btn">ë¡œê·¸ì¸</button></div></form><p class="modal-switch">ì•„ì§ íšŒì›ì´ ì•„ë‹ˆì‹ ê°€ìš”? <a href="#" onclick="closeModal('loginModal');openModal('signupModal');">íšŒì›ê°€ì…</a></p></div></div></div>
  <div class="modal-overlay" id="signupModal"><div class="modal"><div class="modal-header"><h3>íšŒì›ê°€ì…</h3><button type="button" class="modal-close" onclick="closeModal('signupModal')">&times;</button></div><div class="modal-body"><form id="signupForm" onsubmit="return false;"><div class="form-group"><label>ì´ë¦„</label><input type="text" id="signup-name" required></div><div class="form-group"><label>ì´ë©”ì¼</label><input type="email" id="signup-email" required></div><div class="form-group"><label>ë¹„ë°€ë²ˆí˜¸</label><input type="password" id="signup-pw" required minlength="8"></div><div class="form-group"><label>ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label><input type="password" id="signup-pw2" required></div><div class="form-group form-agree"><label><input type="checkbox" required> <a href="terms.html" target="_blank" rel="noopener">ì´ìš©ì•½ê´€</a>Â·<a href="privacy.html" target="_blank" rel="noopener">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>ì— ë™ì˜</label></div><div id="signup-error" class="msg-error" style="display:none;"></div><div id="signup-success" class="msg-success" style="display:none;"></div><div class="modal-footer"><button type="submit" class="btn btn-primary" id="signup-submit-btn">ê°€ì…í•˜ê¸°</button></div></form><p class="modal-switch">ì´ë¯¸ íšŒì›ì´ì‹ ê°€ìš”? <a href="#" onclick="closeModal('signupModal');openModal('loginModal');">ë¡œê·¸ì¸</a></p></div></div></div>

  <footer>
    <div class="footer-inner">
      <p><a href="terms.html">ì´ìš©ì•½ê´€</a> | <a href="privacy.html">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a> | <a href="verify.html">ì¸ì¦ ì•ˆë‚´</a></p>
      <p>Â© 2025â€“2026 ê°€ë§¹ì ìˆ². ì˜¨ë¼ì¸ ê°€ë§¹ì  ì •ë³´ & ì»¤ë®¤ë‹ˆí‹°. All rights reserved.</p>
      <div class="footer-contact">
        <h4>ë¬¸ì˜í•˜ê¸°</h4>
        <p><a href="tel:010-9694-4336">010-9694-4336</a></p>
        <p>ì´ìˆ˜ê´‘</p>
        <p><a href="mailto:leesk0130@naver.com">leesk0130@naver.com</a></p>
        <p>ì„œìš¸íŠ¹ë³„ì‹œ ë™ëŒ€ë¬¸êµ¬ ì´ë¬¸ë™ 317-16 201í˜¸</p>
      </div>
    </div>
  </footer>

  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
  <script src="js/config.js"></script>
  <script src="js/app.js"></script>
  <script>
    (function() {
      document.addEventListener('click', function(e) {
        var btn = e.target && e.target.closest && e.target.closest('.comment-delete-btn');
        if (!btn) return;
        e.preventDefault();
        var postId = btn.getAttribute('data-post-id');
        var commentId = btn.getAttribute('data-comment-id');
        if (!postId || !commentId || !window.app || !window.app.deleteComment) return;
        window.app.deleteComment(postId, commentId, function() {
          window.app.getComments(postId, function(_, comments) {
            window.app.renderComments('comment-list', comments, { postId: postId, canDelete: window.app.isOperator && window.app.isOperator() });
            var countEl = document.getElementById('comment-count');
            if (countEl) countEl.textContent = (comments ? comments.length : 0);
          });
        });
      });

      var params = new URLSearchParams(location.search);
      var postId = params.get('id');
      var listEl = document.getElementById('community-list');
      var detailEl = document.getElementById('view-detail');
      var currentDetailPostId = null;
      var viewState = 'loading';

      function setViewState(state) {
        viewState = state;
        var views = document.querySelectorAll('[data-view]');
        views.forEach(function(el) { el.style.display = (el.getAttribute('data-view') === state) ? '' : 'none'; });
        var card = document.querySelector('.community-section .card');
        if (!card) return;
        var tabs = card.querySelector('.board-tabs');
        var toolbar = card.querySelector('#board-toolbar');
        var actions = card.querySelector('.board-actions');
        var notice = document.getElementById('board-notice');
        var showListUi = (state === 'loading' || state === 'list' || state === 'empty' || state === 'error');
        if (tabs) tabs.style.display = showListUi ? '' : 'none';
        if (toolbar) toolbar.style.display = showListUi ? '' : 'none';
        if (actions) actions.style.display = showListUi ? '' : 'none';
        if (notice) notice.style.display = (showListUi && notice.innerHTML) ? '' : 'none';
      }

      function refreshCommentListWithDeleteFlag() {
        if (!currentDetailPostId || !document.getElementById('comment-list')) return;
        window.app.getComments(currentDetailPostId, function(_, comments) {
          window.app.renderComments('comment-list', comments, { postId: currentDetailPostId, canDelete: window.app.isOperator && window.app.isOperator() });
          var countEl = document.getElementById('comment-count');
          if (countEl) countEl.textContent = (comments ? comments.length : 0);
        });
      }
      window.addEventListener('authStateChanged', refreshCommentListWithDeleteFlag);

      if (postId) {
        var post = window.app.getLocalPostById(postId);
        if (!post) {
          var MOCK = [
            { id: '1', title: 'PGì‚¬ í† ìŠ¤ vs ì´ë‹ˆì‹œìŠ¤ vs ë‚˜ì´ìŠ¤ ìˆ˜ìˆ˜ë£Œ ë¹„êµ í›„ê¸° ìˆì–´ìš”', author: 'ê°€ë§¹ì ì£¼', date: '2ì‹œê°„ ì „', body: 'ê° PGì‚¬ ìˆ˜ìˆ˜ë£Œ ë¹„êµí•´ ë³´ì‹  ë¶„ë“¤ í›„ê¸° ê³µìœ í•´ ì£¼ì„¸ìš”.\n\nì €ëŠ” í† ìŠ¤ ì“°ê³  ìˆëŠ”ë° ì—°íšŒë¹„ 11ë§Œì›ì— ì¹´ë“œ 3.4%ë¼ ë¶€ë‹´ë˜ë„¤ìš”. ì´ë‹ˆì‹œìŠ¤ëŠ” ì—°íšŒë¹„ ë©´ì œë¼ ë°”ê¿€ê¹Œ ê³ ë¯¼ ì¤‘ì´ì—ìš”.', verified: false },
            { id: '2', title: 'ì‡¼í•‘ëª° ì˜¤í”ˆ 3ê°œì›” ì°¨, ì •ì‚° ì¼ì • D+5ë©´ ê´œì°®ì„ê¹Œìš”?', author: 'ì´ˆë³´ì‚¬ì¥', date: '5ì‹œê°„ ì „', body: 'ì •ì‚°ì´ D+5ì¸ PGì‚¬ ê³ ë ¤ ì¤‘ì¸ë°, ìê¸ˆ íšŒì „ì— ë¬´ë¦¬ê°€ ì—†ì„ì§€ ê¶ê¸ˆí•©ë‹ˆë‹¤.', verified: false },
            { id: '3', title: 'ì „ìì„¸ê¸ˆê³„ì‚°ì„œ ìë™ ë°œí–‰ ì—°ë™ PG ì¶”ì²œ ë¶€íƒë“œë ¤ìš”', author: 'íšŒì›', date: 'ì–´ì œ', body: 'ì „ìì„¸ê¸ˆê³„ì‚°ì„œ ìë™ ë°œí–‰ ì˜ ë˜ëŠ” PG ì¶”ì²œí•´ ì£¼ì„¸ìš”.', verified: false },
            { id: '4', title: 'ê²°ì œ ì˜¤ë¥˜ ì‹œ PGì‚¬ ëŒ€ì‘ íŒ ê³µìœ í•©ë‹ˆë‹¤', author: 'ìš´ì˜ì', date: '2ì¼ ì „', body: 'ê²°ì œ ì˜¤ë¥˜ ë°œìƒ ì‹œ PGì‚¬ ê³ ê°ì„¼í„° ì—°ë½ ìš”ë ¹, ë¡œê·¸ í™•ì¸ ë°©ë²• ë“±ì„ ì •ë¦¬í•´ ë‘ì—ˆì–´ìš”.', verified: true },
            { id: '5', title: 'ì˜ì„¸ì‚¬ì—…ì ìˆ˜ìˆ˜ë£Œ ìš°ëŒ€ ë°›ì€ ë¶„ ê³„ì‹ ê°€ìš”?', author: 'ê°€ë§¹ì ì£¼', date: '3ì¼ ì „', body: 'ì˜ì„¸ì‚¬ì—…ìë¡œ ìˆ˜ìˆ˜ë£Œ ìš°ëŒ€ ë°›ê³  ê³„ì‹  ë¶„ í›„ê¸° ë¶€íƒë“œë ¤ìš”.', verified: false }
          ];
          post = MOCK.filter(function(p) { return p.id === postId; })[0];
        }
        if (post && detailEl) {
          setViewState('detail');
          document.getElementById('post-detail-title').textContent = post.title;
          var metaEl = document.getElementById('post-detail-meta');
          var verified = (post.verified === true || (window.app && window.app.isAuthorVerified && window.app.isAuthorVerified(post.author)));
          var badgeHtml = (window.app && window.app.verifiedBadgeHtml) ? window.app.verifiedBadgeHtml(verified, post.author) : '';
          metaEl.innerHTML = (post.author || 'ìµëª…') + badgeHtml + ' Â· ' + (post.date || '');
          document.getElementById('post-detail-body').textContent = post.body || '(ë‚´ìš© ì—†ìŒ)';
          currentDetailPostId = postId;
          var currentPostId = postId;
          function drawComments() {
            window.app.getComments(currentPostId, function(err, comments) {
              window.app.renderComments('comment-list', comments, { postId: currentPostId, canDelete: window.app.isOperator && window.app.isOperator() });
              var countEl = document.getElementById('comment-count');
              if (countEl) countEl.textContent = (comments ? comments.length : 0);
            });
          }
          drawComments();
          setTimeout(drawComments, 600);
          setTimeout(drawComments, 1500);
          var commentForm = document.getElementById('comment-form');
          var nicknameEl = document.getElementById('comment-nickname-value');
          var anonymousCheck = document.getElementById('comment-anonymous');
          if (nicknameEl) {
            var user = window.app.getUser && window.app.getUser();
            if (window.app.isLoggedIn && window.app.isLoggedIn() && user && user.name) {
              nicknameEl.textContent = user.name;
            } else {
              nicknameEl.textContent = 'ë¹„íšŒì› (ìµëª…)';
              if (anonymousCheck) anonymousCheck.checked = true;
            }
          }
          if (commentForm) {
            commentForm.onsubmit = function(e) {
              e.preventDefault();
              var body = document.getElementById('comment-body').value.trim();
              var errEl = document.getElementById('comment-error');
              if (!body) { errEl.textContent = 'ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.'; errEl.style.display = 'block'; return; }
              errEl.style.display = 'none';
              var author = 'ìµëª…';
              if (anonymousCheck && !anonymousCheck.checked) {
                var u = window.app.getUser && window.app.getUser();
                if (u && u.name) author = u.name;
              }
              window.app.addComment(currentPostId, { author: author, body: body }, function(err, comment) {
                if (err) { errEl.textContent = err; errEl.style.display = 'block'; return; }
                document.getElementById('comment-body').value = '';
                window.app.getComments(currentPostId, function(_, comments) {
                  window.app.renderComments('comment-list', comments, { postId: currentPostId, canDelete: window.app.isOperator && window.app.isOperator() });
                  var countEl = document.getElementById('comment-count');
                  if (countEl) countEl.textContent = (comments ? comments.length : 0);
                });
              });
            };
          }
          var card = detailEl.closest('.card');
          if (card) {
            var tabs = card.querySelector('.board-tabs');
            var toolbar = document.getElementById('board-toolbar');
            var actions = card.querySelector('.board-actions');
            if (tabs) tabs.style.display = 'none';
            if (toolbar) toolbar.style.display = 'none';
            if (actions) actions.style.display = 'none';
            var noticeEl2 = document.getElementById('board-notice');
            if (noticeEl2) noticeEl2.style.display = 'none';
          }
          return;
        }
        setViewState('notFound');
        return;
      }

      var board = params.get('board') || 'all';
      var searchQ = params.get('q') || '';
      var sortBy = params.get('sort') || 'latest';
      var tabLinks = document.querySelectorAll('.board-tabs a');
      tabLinks.forEach(function(a) {
        a.classList.remove('active');
        var href = a.getAttribute('href') || '';
        if (board === 'all' && href === 'community.html') a.classList.add('active');
        else if (href.indexOf('board=' + board) !== -1) a.classList.add('active');
      });
      var searchInput = document.getElementById('board-search-input');
      var searchBtn = document.getElementById('board-search-btn');
      var sortSelect = document.getElementById('board-sort-select');
      var moreWrap = document.getElementById('posts-more-wrap');
      var moreBtn = document.getElementById('posts-more-btn');
      var noticeEl = document.getElementById('board-notice');
      if (searchInput) searchInput.value = searchQ;
      if (sortSelect) sortSelect.value = sortBy;

      var allFilteredItems = [];
      var currentShown = 0;
      var PAGE_SIZE = 20;

      function applyFilterAndSort(items) {
        if (!items) return [];
        var q = (searchInput && searchInput.value) ? searchInput.value.trim().toLowerCase() : '';
        var list = q ? items.filter(function(p) { return (p.title || '').toLowerCase().indexOf(q) !== -1 || (p.body || '').toLowerCase().indexOf(q) !== -1; }) : items.slice();
        var s = (sortSelect && sortSelect.value) || 'latest';
        if (s === 'hits') list.sort(function(a, b) { return (b.hits || 0) - (a.hits || 0); });
        return list;
      }

      function renderPage() {
        var toShow = allFilteredItems.slice(0, currentShown);
        if (listEl) window.app.renderPosts('community-list', toShow, 'community.html?id=', true);
        if (toShow.length > 0) setViewState('list'); else setViewState('empty');
        if (moreWrap) moreWrap.style.display = (currentShown < allFilteredItems.length) ? 'block' : 'none';
      }

      function loadList(append) {
        if (!listEl) return;
        if (!append) setViewState('loading');
        window.app.fetchPosts(board, 500, 0, function(err, items) {
          allFilteredItems = applyFilterAndSort(items || []);
          if (!append) currentShown = PAGE_SIZE;
          else currentShown = Math.min(currentShown + PAGE_SIZE, allFilteredItems.length);
          if (!append && currentShown > allFilteredItems.length) currentShown = allFilteredItems.length;
          if (!append) currentShown = Math.min(PAGE_SIZE, allFilteredItems.length);
          renderPage();
        });
      }

      if (moreBtn) moreBtn.onclick = function() { currentShown = Math.min(currentShown + PAGE_SIZE, allFilteredItems.length); renderPage(); };
      var errorRetry = document.getElementById('view-error-retry');
      if (errorRetry) errorRetry.onclick = function() { loadList(false); };

      if (searchBtn && searchInput) {
        searchBtn.onclick = function() {
          var q = searchInput.value.trim();
          var url = 'community.html?board=' + (board || 'all');
          if (q) url += '&q=' + encodeURIComponent(q);
          if (sortSelect && sortSelect.value) url += '&sort=' + sortSelect.value;
          location.href = url;
        };
        searchInput.onkeydown = function(e) { if (e.key === 'Enter') searchBtn.click(); };
      }
      if (sortSelect) sortSelect.onchange = function() { loadList(false); };

      loadList(false);

      if (noticeEl && window.app.getNoticePosts) {
        window.app.getNoticePosts(board, function(err, notices) {
          if (notices && notices.length) {
            noticeEl.style.display = 'block';
            noticeEl.innerHTML = notices.map(function(n) {
              return '<a href="community.html?id=' + (n.id || '') + '" class="board-notice-item"><span class="board-notice-label">ê³µì§€</span> ' + (n.title || '') + '</a>';
            }).join('');
          }
        });
      }
    })();
    function openModal(id) {
      var el = document.getElementById(id);
      if (el) { el.classList.add('is-open'); el.setAttribute('aria-hidden', 'false'); }
      document.body.style.overflow = 'hidden';
    }
    function closeModal(id) {
      var el = document.getElementById(id);
      if (el) { el.classList.remove('is-open'); el.setAttribute('aria-hidden', 'true'); }
      document.body.style.overflow = '';
    }
    document.querySelectorAll('.modal-overlay').forEach(function(el) {
      el.setAttribute('aria-hidden', 'true');
      el.setAttribute('aria-modal', 'true');
      el.setAttribute('role', 'dialog');
      el.addEventListener('click', function(e) { if (e.target === el) closeModal(el.id); });
    });
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        var open = document.querySelector('.modal-overlay.is-open');
        if (open) closeModal(open.id);
      }
    });
    function updateHeaderAuth() {
      var guestEl = document.getElementById('headerAuthGuest');
      var userEl = document.getElementById('headerAuthUser');
      var nameEl = document.getElementById('headerUser');
      if (!guestEl || !userEl) return;
      var loggedIn = window.app && window.app.isLoggedIn && window.app.isLoggedIn();
      var user = window.app && window.app.getUser && window.app.getUser();
      if (loggedIn && user) {
        guestEl.style.display = 'none';
        userEl.style.display = '';
        if (nameEl) nameEl.textContent = (user.name || user.email || 'íšŒì›') + 'ë‹˜';
      } else {
        guestEl.style.display = '';
        userEl.style.display = 'none';
      }
    }
    window.addEventListener('authStateChanged', updateHeaderAuth);
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', updateHeaderAuth); else updateHeaderAuth();
    var loginForm = document.getElementById('loginForm');
    var loginErrorEl = document.getElementById('login-error');
    var loginSuccessEl = document.getElementById('login-success');
    var loginBtn = document.getElementById('login-submit-btn');
    if (loginForm) {
      loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        var email = document.getElementById('login-email').value.trim();
        var pw = document.getElementById('login-pw').value;
        if (loginErrorEl) { loginErrorEl.style.display = 'none'; loginErrorEl.textContent = ''; }
        if (loginSuccessEl) loginSuccessEl.style.display = 'none';
        if (!email || !pw) { if (loginErrorEl) { loginErrorEl.textContent = 'ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.'; loginErrorEl.style.display = 'block'; } return; }
        if (loginBtn) { loginBtn.disabled = true; loginBtn.textContent = 'ë¡œê·¸ì¸ ì¤‘...'; }
        window.app.login(email, pw, function(err, data) {
          if (loginBtn) { loginBtn.disabled = false; loginBtn.textContent = 'ë¡œê·¸ì¸'; }
          if (err) { if (loginErrorEl) { loginErrorEl.textContent = err; loginErrorEl.style.display = 'block'; } return; }
          if (loginErrorEl) loginErrorEl.style.display = 'none';
          if (loginSuccessEl) {
            var userName = (data && data.user && data.user.name) ? data.user.name : (window.app.getUser && window.app.getUser() && window.app.getUser().name) ? window.app.getUser().name : '';
            loginSuccessEl.textContent = userName ? userName + 'ë‹˜, ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤. í™˜ì˜í•´ìš”!' : 'ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤. í™˜ì˜í•´ìš”!';
            loginSuccessEl.style.display = 'block';
          }
          setTimeout(function() {
            closeModal('loginModal');
            if (loginSuccessEl) loginSuccessEl.style.display = 'none';
            updateHeaderAuth();
          }, 1500);
        });
      });
    }
    var signupForm = document.getElementById('signupForm');
    var signupErrorEl = document.getElementById('signup-error');
    var signupSuccessEl = document.getElementById('signup-success');
    var signupBtn = document.getElementById('signup-submit-btn');
    if (signupForm) {
      signupForm.addEventListener('submit', function(e) {
        e.preventDefault();
        var name = document.getElementById('signup-name').value.trim();
        var email = document.getElementById('signup-email').value.trim();
        var pw = document.getElementById('signup-pw').value;
        var pw2 = document.getElementById('signup-pw2').value;
        if (signupErrorEl) signupErrorEl.style.display = 'none';
        if (signupSuccessEl) signupSuccessEl.style.display = 'none';
        if (pw !== pw2) { if (signupErrorEl) { signupErrorEl.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•Šì•„ìš”.'; signupErrorEl.style.display = 'block'; } return; }
        if (pw.length < 8) { if (signupErrorEl) { signupErrorEl.textContent = 'ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì—ìš”.'; signupErrorEl.style.display = 'block'; } return; }
        if (signupBtn) { signupBtn.disabled = true; signupBtn.textContent = 'ê°€ì… ì¤‘...'; }
        window.app.signup(name, email, pw, function(err) {
          if (signupBtn) { signupBtn.disabled = false; signupBtn.textContent = 'ê°€ì…í•˜ê¸°'; }
          if (err) { if (signupErrorEl) { signupErrorEl.textContent = err; signupErrorEl.style.display = 'block'; } return; }
          if (signupSuccessEl) { signupSuccessEl.textContent = 'íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆì–´ìš”. ì ì‹œ í›„ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.'; signupSuccessEl.style.display = 'block'; }
          setTimeout(function() {
            closeModal('signupModal');
            if (signupErrorEl) signupErrorEl.style.display = 'none';
            if (signupSuccessEl) signupSuccessEl.style.display = 'none';
            openModal('loginModal');
            if (document.getElementById('login-email')) document.getElementById('login-email').value = email;
          }, 1800);
        });
      });
    }
    function toggleNav() {
      var nav = document.getElementById('headerNav');
      var btn = document.querySelector('.nav-toggle');
      if (!nav || !btn) return;
      var open = nav.classList.toggle('is-open');
      btn.setAttribute('aria-expanded', open);
      btn.setAttribute('aria-label', open ? 'ë©”ë‰´ ë‹«ê¸°' : 'ë©”ë‰´ ì—´ê¸°');
    }
  </script>
</body>
</html>
